# Production Environment Variables for StudSovet Platform
# These variables are required for production deployment with Directus integration
# WARNING: Replace all placeholder values with actual production secrets

# =============================================================================
# APPLICATION ENVIRONMENT
# =============================================================================
NODE_ENV=production
APP_ENV=production
NUXT_ENV=production

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL database settings for production
DB_HOST=postgres-prod
DB_PORT=5432
DB_NAME=studform_db
DB_USER=studform_db_user
DB_PASSWORD=your_secure_production_db_password
DB_SSL=true

# Database connection pool settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DATABASE_TIMEOUT=10000

# =============================================================================
# DIRECTUS INTEGRATION
# =============================================================================
# Directus instance configuration (replace with your actual Directus URL and tokens)
DIRECTUS_URL=https://your-directus-instance.com
DIRECTUS_TOKEN=your_directus_admin_token
NUXT_PUBLIC_DIRECTUS_URL=https://your-directus-instance.com
NUXT_PUBLIC_DIRECTUS_TOKEN=your_directus_public_token

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# JWT Configuration - Use strong, unique secrets
JWT_SECRET=your_super_secure_jwt_secret_key_minimum_256_bits
JWT_EXPIRES_IN=1h
SESSION_SECRET=your_super_secure_session_secret

# Bcrypt configuration for password hashing
BCRYPT_ROUNDS=14

# Session configuration
SESSION_TIMEOUT=3600
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Restrict CORS to production domains only
CORS_ORIGIN=https://your-domain.com,https://www.your-domain.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-Requested-With

# =============================================================================
# API CONFIGURATION
# =============================================================================
# Server and API settings
PORT=3000
API_PREFIX=/api
REQUEST_TIMEOUT=30000

# Frontend API configuration
NUXT_PUBLIC_API_URL=/api
NUXT_PUBLIC_ENABLE_COMPRESSION=true
NUXT_PUBLIC_CACHE_TTL=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Redis for caching and sessions (if using external Redis)
REDIS_HOST=your-redis-host
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_TIMEOUT=5000
REDIS_DB=0

# =============================================================================
# RATE LIMITING
# =============================================================================
# Production rate limiting settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_FAILED_REQUESTS=false
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Production logging settings
LOG_LEVEL=warn
LOG_FORMAT=json
LOG_FILE=/var/log/app.log

# Log rotation settings
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5
LOG_DATE_PATTERN=YYYY-MM-DD

# =============================================================================
# TELEGRAM BOT CONFIGURATION
# =============================================================================
# Telegram bot settings
BOT_TOKEN=your_telegram_bot_token
WEBHOOK_URL=https://your-domain.com/api/telegram/webhook
TELEGRAM_WEBHOOK_SECRET=your_webhook_secret

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
# File upload settings for production
MAX_FILE_SIZE=10485760
UPLOAD_DIR=/app/uploads
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,doc,docx,xls,xlsx
UPLOAD_SECURE_FILENAMES=true

# =============================================================================
# HEALTH CHECK CONFIGURATION
# =============================================================================
# Health check settings
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=10000
HEALTH_CHECK_RETRIES=3

# =============================================================================
# SECURITY HEADERS CONFIGURATION
# =============================================================================
# HTTP Security Headers
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=true
CONTENT_SECURITY_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https:; frame-ancestors 'none'; base-uri 'self'; form-action 'self'"

# =============================================================================
# MONITORING AND EXTERNAL SERVICES
# =============================================================================
# External service configuration (optional)
SENTRY_DSN=your_sentry_dsn_for_error_tracking
DATADOG_API_KEY=your_datadog_api_key
NEW_RELIC_LICENSE_KEY=your_new_relic_license_key

# =============================================================================
# RESOURCE LIMITS
# =============================================================================
# Application resource limits
MAX_MEMORY_USAGE=512MB
MAX_CPU_USAGE=80%
MAX_CONCURRENT_CONNECTIONS=1000

# =============================================================================
# GRACEFUL SHUTDOWN
# =============================================================================
# Graceful shutdown configuration
GRACEFUL_SHUTDOWN_TIMEOUT=30000
GRACEFUL_SHUTDOWN_SIGNALS=SIGTERM,SIGINT

# =============================================================================
# CIRCUIT BREAKER CONFIGURATION
# =============================================================================
# Circuit breaker for external services
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=60000
CIRCUIT_BREAKER_MONITOR_PERIOD=10000

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================
# Application cache settings
CACHE_TTL=7200
CACHE_MAX_MEMORY=512mb
CACHE_STRATEGY=redis
CACHE_KEY_PREFIX=studsovet:prod:

# =============================================================================
# BACKGROUND JOBS CONFIGURATION
# =============================================================================
# Background job processing
ENABLE_JOBS=true
JOB_QUEUE_CONCURRENCY=10
JOB_QUEUE_ATTEMPTS=3
JOB_QUEUE_BACKOFF_DELAY=5000

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================
# SSL certificate paths (if not using Let's Encrypt)
SSL_CERT_PATH=/etc/ssl/certs/production.crt
SSL_KEY_PATH=/etc/ssl/private/production.key
SSL_CA_PATH=/etc/ssl/certs/ca-bundle.crt

# =============================================================================
# PRODUCTION DEPLOYMENT SPECIFIC
# =============================================================================
# Deployment-specific settings
DEPLOYMENT_ENVIRONMENT=production
DEPLOYMENT_TIMESTAMP=2025-11-16T17:10:32Z
DEPLOYMENT_VERSION=1.0.0

# Container resource constraints
CONTAINER_MEMORY_LIMIT=512M
CONTAINER_CPU_LIMIT=0.5
CONTAINER_MEMORY_RESERVATION=256M
CONTAINER_CPU_RESERVATION=0.25

# =============================================================================
# DATABASE MIGRATIONS
# =============================================================================
# Database migration settings
AUTO_MIGRATE=false
MIGRATION_TIMEOUT=600000
MIGRATION_BATCH_SIZE=1000
MIGRATION_BACKUP_ENABLED=true

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Database backup settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=us-east-1

# =============================================================================
# LOAD BALANCER CONFIGURATION
# =============================================================================
# Load balancer upstream servers (for multiple backend instances)
UPSTREAM_SERVERS=backend-prod-1:3000,backend-prod-2:3000,backend-prod-3:3000
LOAD_BALANCER_ALGORITHM=round_robin
HEALTH_CHECK_PATH=/health

# =============================================================================
# DIRECTUS WEBHOOK CONFIGURATION
# =============================================================================
# Directus webhook settings for real-time updates
DIRECTUS_WEBHOOK_SECRET=your_directus_webhook_secret
DIRECTUS_WEBHOOK_URL=https://your-domain.com/api/directus/webhook
DIRECTUS_SYNC_ENABLED=true
DIRECTUS_SYNC_INTERVAL=300000